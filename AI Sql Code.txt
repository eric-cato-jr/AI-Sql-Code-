
-- 1. Create a Stored Procedure DISPLAY_OWNER_YOURFIRSTNAMELASTNAME  
--AND its corresponding execution/test code.
--This Stored Procedure takes a single parameter/variable named INPUT_PROPERTY_ID to store user input value of a PROPERTY_ID. 


Chat GPT generated:
CREATE PROCEDURE DISPLAY_OWNER_ERICCATO @INPUT_PROPERTY_ID INT
AS
BEGIN
    SELECT *
    FROM PROPERTY P, OWNER O
    WHERE P.OWNER_NUM = O.OWNER_NUM AND P.PROPERTY_ID = @INPUT_PROPERTY_ID;
END;
GO

EXEC DISPLAY_OWNER_ERICCATO 1001;
GO

Improved Code by Eric Cato Jr:

CREATE PROCEDURE DISPLAY_OWNER_ERICCATO @INPUT_PROPERTY_ID INT
AS
BEGIN
    SELECT P.OFFICE_NUM, P.ADDRESS, P.OWNER_NUM, O.FIRST_NAME + ' ' + O.LAST_NAME AS OWNER_NAME  -- Only required columns selected and OWNER_NAME formatted

           FROM PROPERTY P INNER JOIN OWNER O ON P.OWNER_NUM = O.OWNER_NUM  -- Converted implicit join to INNER JOIN

                      WHERE P.PROPERTY_ID = @INPUT_PROPERTY_ID;  -- Used parameterized condition
END;
GO

EXEC DISPLAY_OWNER_ERICCATO 1001;
GO


/*
Improvements Made:
- Replaced implicit join syntax with explicit INNER JOIN for clarity and correctness
- Removed SELECT * to limit output to only required columns
- Formatted owner name using string concatenation for cleaner presentation
- Improved readability and maintainability of the query
*/

-- 2. Create a Stored Procedure UPDATE_OWNER_YOURFIRSTNAMELASTNAME  
-- AND its corresponding execution/test code.
--This Stored Procedure takes 2 parameters/variables:  
--I_OWNER_NUM to store user input value of a OWNER_NUM, and I_LAST_NAME to store user input value of a new LAST_NAME. 
--This stored procedure should update/change the last name to the given value, for the given owner num.	

Code generated by ChatGPT:
CREATE PROCEDURE UPDATE_OWNER_ERICCATO @I_OWNER_NUM CHAR(5), @I_LAST_NAME VARCHAR(50)
AS
BEGIN
    UPDATE OWNER
    SET LAST_NAME = @I_LAST_NAME
    WHERE OWNER_NUM = @I_OWNER_NUM
END;
GO

EXEC UPDATE_OWNER_ERICCATO 'MA111', 'Washington';
GO


Improved code by Eric Cato Jr:
CREATE PROCEDURE UPDATE_OWNER_ERICCATO @I_OWNER_NUM CHAR(5), @I_LAST_NAME VARCHAR(50)
AS
BEGIN
    UPDATE OWNER
    SET LAST_NAME = @I_LAST_NAME  -- Clearly assigns new value to LAST_NAME

           WHERE OWNER_NUM = @I_OWNER_NUM;  -- Matches specific OWNER_NUM
END;
GO

EXEC UPDATE_OWNER_ERICCATO 'MA111', 'Washington';
GO


/*
Improvements Made:
- Verified parameter usage aligns with intended business logic
- Ensured the UPDATE statement targets a specific OWNER_NUM
- Added comments to clarify intent and improve readability
- Maintained clean and consistent formatting for production use
*/


--3.  What other TRIGGER may be appropriate for the PETS OR PROPERTY MANAGEMENT Databases? 
--Describe detailed logics/steps with specific references OR write the trigger query & test codes.

Code generated by ChatGPT:
CREATE TRIGGER trgCheckHours
ON SERVICE_REQUEST
AFTER INSERT
AS
BEGIN
    IF EXISTS (SELECT * FROM INSERTED WHERE EST_HOURS > 10)
        PRINT 'WARNING: Service request exceeds 10 estimated hours.'
END;
GO

Improved code by Eric Cato Jr:
CREATE TRIGGER trgCheckHours ON SERVICE_REQUEST
AFTER INSERT
AS
BEGIN
    DECLARE @HOURS INT;  -- Declares variable to store inserted value

    SELECT @HOURS = EST_HOURS FROM INSERTED;  -- Assigns estimated hours from inserted row

    IF @HOURS > 10  -- Logic check for exceeding threshold
        PRINT 'WARNING: Estimated hours exceed company threshold.';  -- Warning message
END;
GO


/*
Improvements Made:
- Added variable declaration to improve readability and traceability
- Clarified business rule through descriptive warning message
- Structured logic to make trigger behavior easier to understand
- Note: Trigger assumes single-row inserts for instructional purposes
*/

